# 8주차 과제 체크포인트

## 기본 과제

### 필수

- [x] 반복 유형 선택
  - 일정 생성 또는 수정 시 반복 유형을 선택할 수 있다.
  - 반복 유형은 다음과 같다: 매일, 매주, 매월, 매년
    - 만약, 윤년 29일에 또는 31일에 매월 또는 매년 반복일정을 설정한다면 어떻게 처리할까요? 다른 서비스를 참고해보시고 자유롭게 작성해보세요.
- [x] 반복 간격 설정
  - 각 반복 유형에 대해 간격을 설정할 수 있다.
  - 예: 2일마다, 3주마다, 2개월마다 등
- [x] 반복 일정 표시
  - 캘린더 뷰에서 반복 일정을 시각적으로 구분하여 표시한다.
    - 아이콘을 넣든 태그를 넣든 자유롭게 해보세요!
- [x] 반복 종료
  - 반복 종료 조건을 지정할 수 있다.
  - 옵션: 특정 날짜까지, 특정 횟수만큼, 또는 종료 없음 (예제 특성상, 2025-06-30까지) 
    // 종료날짜 설정 안하면 최대 1개월로 적용 되게함
- [x] 반복 일정 단일 수정
  - 반복일정을 수정하면 단일 일정으로 변경됩니다.
  - 반복일정 아이콘도 사라집니다.
- [x] 반복 일정 단일 삭제
  - 반복일정을 삭제하면 해당 일정만 삭제합니다.

### 선택

- [ ] 예외 날짜 처리:
  - 반복 일정 중 특정 날짜를 제외할 수 있다.
  - 반복 일정 중 특정 날짜의 일정을 수정할 수 있다.
- [x] 요일 지정 (주간 반복의 경우):
  - 주간 반복 시 특정 요일을 선택할 수 있다.
- [ ] 월간 반복 옵션:
  - 매월 특정 날짜에 반복되도록 설정할 수 있다.
  - 매월 특정 순서의 요일에 반복되도록 설정할 수 있다.
- [x] 반복 일정 전체 수정 및 삭제
  - 반복 일정의 모든 일정을 수정할 수 있다.
  - 반복 일정의 모든 일정을 삭제할 수 있다.

## 심화 과제

- [x] 이 앱에 적합한 테스트 전략을 만들었나요?

### 각 팀원들의 테스트 전략은?

본인의 테스트 전략
 - 최대한 TDD 기반으로 작성해보기
    - 테스트 코드 시나리오를 먼저 작성하려니 아직은 감이 잘 오지 않아 
      간단한 시나리오 구상 후 공통 기능 먼저 개발
    - 반복 일정 테스트 위주이므로, 반복 일정을 등록하는 기능을 먼저 구현
    - 반복 일정 구현 후 테스트 코드 세부 사항 작성과 디버깅을 통해 작성한 코드 수정
    - 원하는 기능에 맞게 테스트 코드 작성 및 통과 시키기

### 합의된 테스트 전략과 그 이유는 무엇인가요?

팀원 분들과 토론을 가지지 못했습니다.

### 추가로 작성된 테스트 코드는 어떤 것들이 있나요?

medium.integration.spec.tsx 파일에 이어서 진행했습니다.

추가된 테스트 코드

  반복 일정 기능
  - 반복 일정 생성시 반복 일정이 표시된다
  - 반복 일정을 단일 수정하면 반복 아이콘이 사라진다
  - 반복 일정 단일 삭제시 해당 일정만 삭제된다
  - 윤년 2월 29일에 매월 반복 설정시 해당 월의 마지막 날에 일정이 생성된다

---

## 과제 셀프회고

지난주에 이어 테스트 코드 작성 과제였습니다.
저번주도 어려웠지만, 이번 과제는 서버를 만지고 함수 작성에 
테스트코드까지 진행하니 머리가 좀 아픈 한주였습니다.

TDD 기반으로 작업을 해보니 (완벽하게 하진 못했지만) 그래도 어떤 방식으로 코드를 작성할지
감이 오는 것 같습니다.

예전 같았으면 AI 붙잡고 뭘 어떻게 해야하는지 물어보고 시키는대로 작성 했을 것 같은데,
흐름이 보이니 반복 일정 기능을 만드는데 어디다 무엇을 해야하는지 
server.js파일이나 어느 함수에 살을 더 붙여야 하는지 파악이 쉽게 되었습니다.
(하지만 코드를 작성하고 테스트 통과 까지는 전혀 쉽지 않았음)

### 기술적 성장

테스트 코드를 작성하고 어디서 계속 실패가 나는지 디버깅을 해가며
jsdom과 브라우저 환경의 차이를 이전보다 많이 이해했습니다.
  1. 시간 처리 차이
    - jsdom에선 vi.setSystemTime을 통해 가상 시간을 사용할 수 있었습니다.
      - beforeEach(() => {
          vi.setSystemTime(new Date('2024-10-01'));
        });

  2. 이벤트 시뮬
    - 테스트에서는 이벤트를 수동으로 작동시켰습니다
      await user.click(screen.getByTestId('event-submit-button'));
      userEvent로 프로그래밍적으로 시뮬레이션. 브라우저는 실제 사람이

  3. 비동기 처리
    - 기존에는 async, await만 알고 있었는데 테스트에선 act()까지 사용했습니다.

  4. 네트워크 요청
    - MSW로 API 요청 모킹
      server.use(http.get('/api/events', () =>{...}));

저번주차부터 모킹이 뭐지? 했던게 좀 있었는데, 이제 좀 알게된 것 같습니다.
  - Mocking: 테스트할 때 실제 객체 대신 가짜 객체를 만들어 사용하는 것 
    - server.use(
        http.get('/api/events', () => {
          return HttpResponse.json({
            events: [
              {
                id: 1,
                title: '팀 회의',
                date: '2024-10-15',
                startTime: '09:00',
                endTime: '10:00',
                ...
              }
            ]
          });
        })
      );
      위 작업이 실제 서버 응답을 흉내내는 가짜 응답을 만드는 것
    - 모킹을 하는 이유?
      - 실제 서버 없이도 테스트가 가능함
      - 다양한 상황을 테스트하기 용이함
      - 테스트 속도 향상 및 안전성 확보

이번 회차 과제에도 제대로된 정보 습득 없이 진행하다 해결 못할뻔 한 부분이 있었습니다.
테스트 과제를 진행하면서 테스트 실패 오류와 브라우저 환경만 비교하며 진행하니 
이상한 곳만 계속 파고 있었습니다.    
그러다 토요지식회때 테스트 관련 내용이 있던걸 기억하고, 
지난 토요지식회와 저번주, 이번주 학습 자료를 다시 본 뒤 jsdom 환경에서 디버깅을 시작해 
문제를 해결했습니다. 해결 못하던 문제는
시스템 시간 설정이  
  beforeEach(() => {
    vi.setSystemTime(new Date('2024-10-01'));
  });
처럼 24년 10월로 설정되어 있어 24년 10월 달력에서 시작하지만, 
반복 일정 테스트는 25년 2월 날짜로 만들고 24년 10월 달력에서 25년 2월 반복일정 찾아! 를 시키고 있었습니다.
브라우저 환경에서는 반복 일정이 제대로 생성 되는데, 테스트는 찾지 못하니 어질어질 했습니다.
파일을 잘 살펴보지 않은 잘못도 있지만, jsdom 환경에서 테스트 디버깅 하는 방법을 알았더라면
빠르게 해결하지 않았을까 생각합니다.

### 코드 품질

아직 '잘 작성된 코드다' 라고 평가할만한 수준이 아닌 것 같습니다.

## 리뷰 받고 싶은 내용

이번 과제는 TDD 생각한다고 과제를 진행함에 있어 MSW 인지를 못하고 한 것 같습니다.
테스트는 어찌 통과가 되었는데, 요구사항에 잘 맞는 코드인지 잘 모르겠어요.
